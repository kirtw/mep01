<!DOCTYPE html>
<html lang='en'>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>
^TOId2
</title>
<style> 
.hd  {font-size: 2em;}
body  {font-size:100%;}
.cdline  {font-family: "Courier New", monospace;   font-size: 1em;}
.cdline  {display: flex; flex-direction: row; flex-wrap: nowrap; justify-content: space-between; }
.cdrinum  {flex: 1;}
.cdlabel  {flex: 5;}
.cdmcmd  {flex: 94;}
.cdline  {white-space:pre-wrap; }
.cdmcmd  {text-indent:5px white-space:pre-wrap;}
.cdline  {background-color:gray}
.cdrinum  {background-color:gold; width:100px ; margin-right:5px}
.cdlabel  {background-color:lightblue}
.cdmcmd  {background-color:lightpink}
a  {margin:5px 0px 5px 0px;}
.brcln  {display: flex; flex-direction: row; flex-wrap: nowrap; justify-content: space-between; }
a  {flex: 1;}
.blink  {flex: 1;}
.brcln  {white-space:pre-wrap; flex-wrap: wrap;}
.brcln  {font-size: 1.4em; font-family: "Courier New", monospace; }
.blink  {margin-left: 10px;margin-right: 10px;text-decoration: none;}
.blink  {padding-left: 5px; padding-right: 20px;border: black solid 1px;}
.blink  {background-color: lightpink;}
.cursor  {background-color:lightyellow;}
</style>
</head>
<body>
<div  class=hd >MRoutine Page ^TOId2</div><a href=aa-TOC-All.zz2.html >TOC</a><div  class=brcln ><a href=aa-TOC-All.zz2.html >TOC</a><div  class=blink ><a href=RD-rTOI7.rd2.html >rTOI7/</a></div><div  class=blink ><a href=MR-TOId2.mr2.html >^TOId2</a></div><div  class=blink ><a href=./ >ww2m/*</a></div><div  class=blink ><a href=CB-TOId2.cb2.html >^TOId2</a></div><div  class=blink ><a href=CB-TOId2-A.cb2.html >A</a></div><div  class=blink ><a href=CB-TOId2-B.cb2.html >B</a></div><div  class=blink ><a href=CB-TOId2-dtm.cb2.html >dtm</a></div><div  class=blink ><a href=CB-TOId2-II.cb2.html >II</a></div><div  class=blink ><a href=CB-TOId2-Def.cb2.html >Def</a></div><div  class=blink ><a href=CB-TOId2-SDlst.cb2.html >SDlst</a></div><div  class=blink ><a href=CB-TOId2-Sdef.cb2.html >Sdef</a></div><div  class=blink ><a href=CB-TOId2-d12p.cb2.html >d12p</a></div><div  class=blink ><a href=CB-TOId2-dayp.cb2.html >dayp</a></div><div  class=blink ><a href=CB-TOId2-dtn.cb2.html >dtn</a></div><div  class=blink ><a href=CB-TOId2-Se.cb2.html >Se</a></div><div  class=blink ><a href=CB-TOId2-yr.cb2.html >yr</a></div><div  class=blink ><a href=CB-TOId2-mn.cb2.html >mn</a></div><div  class=blink ><a href=CB-TOId2-day.cb2.html >day</a></div><div  class=blink ><a href=CB-TOId2-nyr.cb2.html >nyr</a></div><div  class=blink ><a href=CB-TOId2-Xdate.cb2.html >Xdate</a></div><div  class=blink ><a href=CB-TOId2-nMon.cb2.html >nMon</a></div><div  class=blink ><a href=CB-TOId2-year.cb2.html >year</a></div><div  class=blink ><a href=CB-TOId2-WKN.cb2.html >WKN</a></div><div  class=blink ><a href=CB-TOId2-dydt.cb2.html >dydt</a></div><div  class=blink ><a href=CB-TOId2-cdjw.cb2.html >cdjw</a></div><div  class=blink ><a href=CB-TOId2-time.cb2.html >time</a></div><div  class=blink ><a href=CB-TOId2-dpr.cb2.html >dpr</a></div></div><div  class=mcode ><div  class=cdline ><div  class=cdrinum >..1c</div><div  class=cdmcmd >TOId2   ;CKW/ESC   i22jan18  gmsa/  rTOI7/ ; 20191002-94 ; Find a Date Field TOI</div></div><div  class=cdline ><div  class=cdrinum >..2c</div><div  class=cdmcmd >  ; 20sep20 cqlog-&gt; <a href=CB-devIO-devlog.cb2.html >devlog</a>   rev 9oct Use WD() not <a href=CB-dmnu-L2.cb2.html >L2</a>  8aug19    </div></div><div  class=cdline ><div  class=cdrinum >..3c</div><div  class=cdmcmd >  ; At least one / or - not just <a href=CB-TOId2-day.cb2.html >day</a> of month vs amt/num</div></div><div  class=cdline ><div  class=cdrinum >..4c</div><div  class=cdmcmd >;    Wpnd(wki)-&gt; wki, WD(wki)</div></div><div  class=cdline ><div  class=cdrinum >..5c</div><div  class=cdmcmd >;  Defaults  Ddef(<a href=CB-GAscan-vn.cb2.html >vn</a>)=val  Dlst()  <a href=CB-GAscan-vn.cb2.html >vn</a> in {<a href=CB-TOId2-yr.cb2.html >yr</a>,mo,wkn,dat,apm,  d12, dj, <a href=CB-dv2-wh.cb2.html >wh</a>}</div></div><div  class=cdline ><div  class=cdrinum >..6c</div><div  class=cdmcmd >A    D B,<a href=CB-TOId2-Def.cb2.html >Def</a>,<a href=CB-TOId2-dtm.cb2.html >dtm</a>,<a href=CB-TOId2-Sdef.cb2.html >Sdef</a>,<a href=CB-TOId2-SDlst.cb2.html >SDlst</a></div></div><div  class=cdline ><div  class=cdrinum >..7c</div><div  class=cdmcmd >     Q</div></div><div  class=cdline ><div  class=cdrinum >..8c</div><div  class=cdmcmd >;* <a href=CB-dzRcfg-d2.cb2.html >d2</a> Variant One wki at a <a href=CB-TOId2-time.cb2.html >time</a> to coclusions, Wty, Wr</div></div><div  class=cdline ><div  class=cdrinum >..9c</div><div  class=cdmcmd >B    ;I $G(<a href=CB-TOIimg-toiFL.cb2.html >toiFL</a>)="" D ^TOIimg  ; : <a href=CB-TOIimg-dtFL.cb2.html >dtFL</a>, <a href=CB-TOIimg-toiFL.cb2.html >toiFL</a> ^TG(0</div></div><div  class=cdline ><div  class=cdrinum >.10c</div><div  class=cdmcmd >     NEW d8,<a href=CB-dv2-wh.cb2.html >wh</a>,djw,dQ D <a href=CB-jfm~1-II.cb2.html >II</a></div></div><div  class=cdline ><div  class=cdrinum >.11c</div><div  class=cdmcmd >     ;;dQ 1 date found, exit series of format tests</div></div><div  class=cdline ><div  class=cdrinum >.12c</div><div  class=cdmcmd >     S <a href=CB-kfm~1-qd.cb2.html >qD</a>=0,wki=0 F wn=0:1 S wki=$O(Wpnd(wki)) Q:wki=""  DO  ;</div></div><div  class=cdline ><div  class=cdrinum >.13c</div><div  class=cdmcmd >       .S wd=$G(Wdlc(wki)) I wd="" Q</div></div><div  class=cdline ><div  class=cdrinum >.14c</div><div  class=cdmcmd >       .S wd=$<a href=CB-dzIzro-TR.cb2.html >TR</a>(wd,"-","/")  ;treat / and - the same, switch to /</div></div><div  class=cdline ><div  class=cdrinum >.15c</div><div  class=cdmcmd >       .I wd["/" D <a href=CB-TOId2-dayp.cb2.html >dayp</a> I dQ S dwki=wki D S9^TOIp("d8",d8) D b^dv("Log dayp","dwki,d8,d12") Q</div></div><div  class=cdline ><div  class=cdrinum >.16c</div><div  class=cdmcmd >       .D <a href=CB-TOId2-dtn.cb2.html >dtn</a> Q:dQ</div></div><div  class=cdline ><div  class=cdrinum >.17c</div><div  class=cdmcmd >       .D <a href=CB-TOId2-dydt.cb2.html >dydt</a> Q:dQ</div></div><div  class=cdline ><div  class=cdrinum >.18c</div><div  class=cdmcmd >     S wki=0 F wn=0:1 S wki=$O(Wpnd(wki)) Q:wki=""  DO  ;Ck wds following d8</div></div><div  class=cdline ><div  class=cdrinum >.19c</div><div  class=cdmcmd >       .S tm1=$G(Wd(wki)) I tm1'="" DO  ;</div></div><div  class=cdline ><div  class=cdrinum >.20c</div><div  class=cdmcmd >          ..D <a href=CB-TOId2-time.cb2.html >time</a></div></div><div  class=cdline ><div  class=cdrinum >.21c</div><div  class=cdmcmd >          ..S <a href=CB-TOId2-dtm.cb2.html >dtm</a>=<a href=CB-hgh-hr.cb2.html >hr</a>_min</div></div><div  class=cdline ><div  class=cdrinum >.22c</div><div  class=cdmcmd >           ..I <a href=CB-TOId2-dtm.cb2.html >dtm</a>'?4n D b^dv("Err <a href=CB-TOId2-time.cb2.html >time</a> ?4n","dtm,<a href=CB-hgh-hr.cb2.html >hr</a>,min,d8,d12,dQ,wki,ri,L") Q</div></div><div  class=cdline ><div  class=cdrinum >.23c</div><div  class=cdmcmd >           ..S d12=d8_<a href=CB-TOId2-dtm.cb2.html >dtm</a></div></div><div  class=cdline ><div  class=cdrinum >.24c</div><div  class=cdmcmd >          ..D S9^TOIp("dtm",<a href=CB-TOId2-dtm.cb2.html >dtm</a>)</div></div><div  class=cdline ><div  class=cdrinum >.25c</div><div  class=cdmcmd >          ..D b^dv("Log time","hr,min,<a href=CB-TOId2-dtm.cb2.html >dtm</a>,d12,d8")  ;not tested yet</div></div><div  class=cdline ><div  class=cdrinum >.26c</div><div  class=cdmcmd >              ; Now combine all date-<a href=CB-TOId2-time.cb2.html >time</a> vars, @<a href=CB-dvzb-DVL.cb2.html >DVL</a>,  and -&gt; Wty</div></div><div  class=cdline ><div  class=cdrinum >.27c</div><div  class=cdmcmd >              ;  <a href=CB-TOId2-yr.cb2.html >yr</a>,<a href=CB-TOId2-mn.cb2.html >mn</a>,<a href=CB-TOId2-day.cb2.html >day</a>, apm,<a href=CB-hgh-hr.cb2.html >hr</a>,min  : d8,d12 ?week also</div></div><div  class=cdline ><div  class=cdrinum >.28c</div><div  class=cdmcmd ><a href=CB-TOId2-dtm.cb2.html >dtm</a>   S (d12,d8)="" D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("dtm") </div></div><div  class=cdline ><div  class=cdrinum >.29c</div><div  class=cdmcmd >      I <a href=CB-TOId2-mn.cb2.html >mn</a>?1n S <a href=CB-TOId2-mn.cb2.html >mn</a>="0"_<a href=CB-TOId2-mn.cb2.html >mn</a> D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("lzmn")  D b^dv("err vs $$mn","mn,L,ri")</div></div><div  class=cdline ><div  class=cdrinum >.30c</div><div  class=cdmcmd >      I <a href=CB-TOId2-day.cb2.html >day</a>?1n S <a href=CB-TOId2-day.cb2.html >day</a>="0"_<a href=CB-TOId2-day.cb2.html >day</a> D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("lzday") D b^dv("err vs $$day","day,L,ri")</div></div><div  class=cdline ><div  class=cdrinum >.31c</div><div  class=cdmcmd >      I <a href=CB-TOId2-yr.cb2.html >yr</a>?2n S <a href=CB-TOId2-yr.cb2.html >yr</a>="20"_<a href=CB-TOId2-yr.cb2.html >yr</a> D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("yrl20")  D b^dv("err vs $$yr","yr,L,ri")</div></div><div  class=cdline ><div  class=cdrinum >.32c</div><div  class=cdmcmd >      S d=<a href=CB-TOId2-yr.cb2.html >yr</a>_<a href=CB-TOId2-mn.cb2.html >mn</a>_<a href=CB-TOId2-day.cb2.html >day</a> I d?8n S d8=d_"_"</div></div><div  class=cdline ><div  class=cdrinum >.33c</div><div  class=cdmcmd >      I <a href=CB-hgh-hr.cb2.html >hr</a>?1n S <a href=CB-hgh-hr.cb2.html >hr</a>="0"_<a href=CB-hgh-hr.cb2.html >hr</a> D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("lzhr")</div></div><div  class=cdline ><div  class=cdrinum >.34c</div><div  class=cdmcmd >      I min?1n S min="0"_min D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("lzmin")</div></div><div  class=cdline ><div  class=cdrinum >.35c</div><div  class=cdmcmd >      S d=<a href=CB-TOId2-yr.cb2.html >yr</a>_<a href=CB-TOId2-mn.cb2.html >mn</a>_<a href=CB-TOId2-day.cb2.html >day</a>_"_"_<a href=CB-hgh-hr.cb2.html >hr</a>_min </div></div><div  class=cdline ><div  class=cdrinum >.36c</div><div  class=cdmcmd >      I d?8n1"_"4n S d12=d</div></div><div  class=cdline ><div  class=cdrinum >.37c</div><div  class=cdmcmd >        I d12'?8n1"_"4nn D ^deverr("d12 <a href=CB-dv2-err.cb2.html >err</a> ","d12,d,<a href=CB-TOId2-yr.cb2.html >yr</a>,<a href=CB-TOId2-mn.cb2.html >mn</a>,<a href=CB-TOId2-day.cb2.html >day</a>,<a href=CB-hgh-hr.cb2.html >hr</a>,min,dt1,dt2,ri,L0,L2") Q</div></div><div  class=cdline ><div  class=cdrinum >.38c</div><div  class=cdmcmd >        I d8'?8n1"_" D ^deverr("d8 err","d8,d12,d,<a href=CB-TOId2-yr.cb2.html >yr</a>,<a href=CB-TOId2-mn.cb2.html >mn</a>,<a href=CB-TOId2-day.cb2.html >day</a>,ri,L0,<a href=CB-dmnu-L2.cb2.html >L2</a>,L") Q</div></div><div  class=cdline ><div  class=cdrinum >.39c</div><div  class=cdmcmd >      ;</div></div><div  class=cdline ><div  class=cdrinum >.40c</div><div  class=cdmcmd >      I dwki'=wki D b^dv("ck need for dwki","dwki,wki,ri,L0")</div></div><div  class=cdline ><div  class=cdrinum >.41c</div><div  class=cdmcmd >      I dwki="" D b^dv("Err no dwki","dwki,wki,nsp,d8,d12,ri") Q</div></div><div  class=cdline ><div  class=cdrinum >.42c</div><div  class=cdmcmd >      S wki=dwki </div></div><div  class=cdline ><div  class=cdrinum >.43c</div><div  class=cdmcmd >      D S9^TOIp("d8",d8)</div></div><div  class=cdline ><div  class=cdrinum >.44c</div><div  class=cdmcmd >      Q</div></div><div  class=cdline ><div  class=cdrinum >.45c</div><div  class=cdmcmd >;*</div></div><div  class=cdline ><div  class=cdrinum >.46c</div><div  class=cdmcmd ><a href=CB-jfm~1-II.cb2.html >II</a>   S <a href=CB-dzCzro-az.cb2.html >AZ</a>="ABCDEFGHIJKLMNOPQRSTUVWXYZ",<a href=CB-dzCzro-az.cb2.html >Az</a>="abcdefghijklmnopqrstuvwxyz"</div></div><div  class=cdline ><div  class=cdrinum >.47c</div><div  class=cdmcmd >     S dyL="mon,tue,wed,thu,fri,sat,sun,"</div></div><div  class=cdline ><div  class=cdrinum >.48c</div><div  class=cdmcmd >     S moL="jan,feb,mar,apr,may,jun,jul,aug,sep,oct,nov,dec,"</div></div><div  class=cdline ><div  class=cdrinum >.49c</div><div  class=cdmcmd >     Q</div></div><div  class=cdline ><div  class=cdrinum >.50c</div><div  class=cdmcmd >;*  Derive Defaults from Ddef(), where <a href=CB-TOId2-day.cb2.html >day</a>, <a href=CB-hgh-hr.cb2.html >hr</a> etc are still null</div></div><div  class=cdline ><div  class=cdrinum >.51c</div><div  class=cdmcmd ><a href=CB-TOId2-Def.cb2.html >Def</a>  I <a href=CB-TOId2-yr.cb2.html >yr</a>="" S <a href=CB-TOId2-yr.cb2.html >yr</a>=$G(Ddef("yr"))</div></div><div  class=cdline ><div  class=cdrinum >.52c</div><div  class=cdmcmd >     I <a href=CB-TOId2-day.cb2.html >day</a>="" S <a href=CB-TOId2-day.cb2.html >day</a>=$G(Dlst("day")) I <a href=CB-TOId2-day.cb2.html >day</a> S <a href=CB-TOId2-mn.cb2.html >mn</a>=$G(Dlst(<a href=CB-TOId2-mn.cb2.html >mn</a>)),<a href=CB-TOId2-yr.cb2.html >yr</a>=$G(Dlst("yr"))</div></div><div  class=cdline ><div  class=cdrinum >.53c</div><div  class=cdmcmd >     I <a href=CB-TOId2-day.cb2.html >day</a>="" S <a href=CB-TOId2-day.cb2.html >day</a>=$G(Ddef("day")) I day&gt;0 S <a href=CB-TOId2-mn.cb2.html >mn</a>=$G(Ddef("mn")),<a href=CB-TOId2-yr.cb2.html >yr</a>=$G(Ddef("yr"))</div></div><div  class=cdline ><div  class=cdrinum >.54c</div><div  class=cdmcmd >     I <a href=CB-TOId2-mn.cb2.html >mn</a>="" S <a href=CB-TOId2-mn.cb2.html >mn</a>=$G(Dlst("mn")) D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("deflstmn") I <a href=CB-TOId2-mn.cb2.html >mn</a> S:$G(Dlst("yr")) <a href=CB-TOId2-yr.cb2.html >yr</a>=Dlst("yr")</div></div><div  class=cdline ><div  class=cdrinum >.55c</div><div  class=cdmcmd >     I <a href=CB-TOId2-mn.cb2.html >mn</a>="" S <a href=CB-TOId2-mn.cb2.html >mn</a>=$G(Ddef("mn")) D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("defdefmn") I <a href=CB-TOId2-mn.cb2.html >mn</a> S:$G(Ddef("yr")) <a href=CB-TOId2-yr.cb2.html >yr</a>=Ddef("yr")</div></div><div  class=cdline ><div  class=cdrinum >.56c</div><div  class=cdmcmd >     I <a href=CB-TOId2-yr.cb2.html >yr</a>="" S <a href=CB-TOId2-yr.cb2.html >yr</a>=$G(Dlst("yr")) D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("defyr") I <a href=CB-TOId2-yr.cb2.html >yr</a>="" S <a href=CB-TOId2-yr.cb2.html >yr</a>=$G(Ddef("yr"))</div></div><div  class=cdline ><div  class=cdrinum >.57c</div><div  class=cdmcmd >     I <a href=CB-TOId2-day.cb2.html >day</a>="" D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("defday") DO  </div></div><div  class=cdline ><div  class=cdrinum >.58c</div><div  class=cdmcmd >        .I $G(Ddef("d12")) S d12=Ddef("d12") I d12?12n D <a href=CB-TOId2-d12p.cb2.html >d12p</a> Q</div></div><div  class=cdline ><div  class=cdrinum >.59c</div><div  class=cdmcmd >        .I $G(Dlst("d12")) S d12=Dlst("d12") I d12?12n D <a href=CB-TOId2-d12p.cb2.html >d12p</a> Q</div></div><div  class=cdline ><div  class=cdrinum >.60c</div><div  class=cdmcmd >        .I $G(Ddef("day")) S <a href=CB-TOId2-day.cb2.html >day</a>=Ddef("day"),<a href=CB-TOId2-mn.cb2.html >mn</a>=$G(Ddef("mn")),<a href=CB-TOId2-yr.cb2.html >yr</a>=$G(Ddef("yr"))</div></div><div  class=cdline ><div  class=cdrinum >.61c</div><div  class=cdmcmd >     I <a href=CB-hgh-hr.cb2.html >hr</a>="" S <a href=CB-hgh-hr.cb2.html >hr</a>=$G(Dlst("hr")),min=$G(Dlst("min")) I <a href=CB-hgh-hr.cb2.html >hr</a>="" S <a href=CB-hgh-hr.cb2.html >hr</a>="00",min="00"</div></div><div  class=cdline ><div  class=cdrinum >.62c</div><div  class=cdmcmd >     ;I <a href=CB-dv2-wh.cb2.html >wh</a>="",d12?12n S whj=$$d8whj^dd($E(d12,1,8)),<a href=CB-dv2-wh.cb2.html >wh</a>=+whj,djw=$P(whj,"-",2)</div></div><div  class=cdline ><div  class=cdrinum >.63c</div><div  class=cdmcmd >     Q</div></div><div  class=cdline ><div  class=cdrinum >.64c</div><div  class=cdmcmd >;* <a href=CB-KGD-save.cb2.html >Save</a> Dlst()  LAST vs Default   vs end of <a href=CB-TOId2-dtm.cb2.html >dtm</a> already, redone here</div></div><div  class=cdline ><div  class=cdrinum >.65c</div><div  class=cdmcmd ><a href=CB-TOId2-SDlst.cb2.html >SDlst</a> KILL Dlst I d12?12n S Dlst("d12")=d12 ;D <a href=CB-TOId2-d12p.cb2.html >d12p</a> </div></div><div  class=cdline ><div  class=cdrinum >.66c</div><div  class=cdmcmd >     S Dlst("yr")=<a href=CB-TOId2-yr.cb2.html >yr</a>,Dlst("mn")=<a href=CB-TOId2-mn.cb2.html >mn</a>,Dlst("day")=<a href=CB-TOId2-day.cb2.html >day</a></div></div><div  class=cdline ><div  class=cdrinum >.67c</div><div  class=cdmcmd >     S Dlst("hr")=<a href=CB-hgh-hr.cb2.html >hr</a>,Dlst("min")=min,Dlst("apm")=apm</div></div><div  class=cdline ><div  class=cdrinum >.68c</div><div  class=cdmcmd >     I $G(<a href=CB-dv2-wh.cb2.html >wh</a>) S Dlst("wh")=<a href=CB-dv2-wh.cb2.html >wh</a></div></div><div  class=cdline ><div  class=cdrinum >.69c</div><div  class=cdmcmd >     Q</div></div><div  class=cdline ><div  class=cdrinum >.70c</div><div  class=cdmcmd >;*   from end of <a href=CB-TOId2-dtm.cb2.html >dtm</a></div></div><div  class=cdline ><div  class=cdrinum >.71c</div><div  class=cdmcmd ><a href=CB-TOId2-Sdef.cb2.html >Sdef</a>  F <a href=CB-GAscan-vn.cb2.html >vn</a>="d12","yr","mn","day","hr","min" S Dlst(<a href=CB-GAscan-vn.cb2.html >vn</a>)=$G(@<a href=CB-GAscan-vn.cb2.html >vn</a>)  ; sic vs <a href=CB-TOIimg-dtFL.cb2.html >dtFL</a> ? not <a href=CB-dv2-wh.cb2.html >wh</a></div></div><div  class=cdline ><div  class=cdrinum >.72c</div><div  class=cdmcmd >      Q</div></div><div  class=cdline ><div  class=cdrinum >.73c</div><div  class=cdmcmd >;*  d12 -&gt; <a href=CB-TOId2-yr.cb2.html >yr</a>,<a href=CB-TOId2-mn.cb2.html >mn</a>,<a href=CB-TOId2-day.cb2.html >day</a>, <a href=CB-hgh-hr.cb2.html >hr</a>,min</div></div><div  class=cdline ><div  class=cdrinum >.74c</div><div  class=cdmcmd ><a href=CB-TOId2-d12p.cb2.html >d12p</a> S <a href=CB-TOId2-day.cb2.html >day</a>=$E(d12,7,8),<a href=CB-TOId2-mn.cb2.html >mn</a>=$E(d12,5,6),<a href=CB-TOId2-yr.cb2.html >yr</a>=$E(d12,1,4)</div></div><div  class=cdline ><div  class=cdrinum >.75c</div><div  class=cdmcmd >     S <a href=CB-hgh-hr.cb2.html >hr</a>=$E(d12,9,10),min=$E(d12,11,12)</div></div><div  class=cdline ><div  class=cdrinum >.76c</div><div  class=cdmcmd >     Q</div></div><div  class=cdline ><div  class=cdrinum >.77c</div><div  class=cdmcmd >;*</div></div><div  class=cdline ><div  class=cdrinum >.78c</div><div  class=cdmcmd >;*  wd split by/ 2 or 3  : dQ, <a href=CB-TOId2-yr.cb2.html >yr</a>, <a href=CB-TOId2-mn.cb2.html >mn</a>, <a href=CB-TOId2-day.cb2.html >day</a></div></div><div  class=cdline ><div  class=cdrinum >.79c</div><div  class=cdmcmd ><a href=CB-TOId2-dayp.cb2.html >dayp</a>  S Ln=$L(wd,"/"),p1=$P(wd,"/"),p2=$P(wd,"/",2),p3=$P(wd,"/",3)</div></div><div  class=cdline ><div  class=cdrinum >.80c</div><div  class=cdmcmd >        ;I p1'?1.2n!(p2'?1.2n) Q  ; some other use of /</div></div><div  class=cdline ><div  class=cdrinum >.81c</div><div  class=cdmcmd >      I Ln=3 S <a href=CB-TOId2-yr.cb2.html >yr</a>=$$<a href=CB-TOId2-yr.cb2.html >yr</a>(p3),<a href=CB-TOId2-mn.cb2.html >mn</a>=$$<a href=CB-TOId2-mn.cb2.html >mn</a>(p1),<a href=CB-TOId2-day.cb2.html >day</a>=$$<a href=CB-TOId2-day.cb2.html >day</a>(p2) DO  Q:dQ</div></div><div  class=cdline ><div  class=cdrinum >.82c</div><div  class=cdmcmd >          .S d8=<a href=CB-TOId2-yr.cb2.html >yr</a>_<a href=CB-TOId2-mn.cb2.html >mn</a>_<a href=CB-TOId2-day.cb2.html >day</a>_"_" D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("3/d8")</div></div><div  class=cdline ><div  class=cdrinum >.83c</div><div  class=cdmcmd >          .I d8?8n1"_" D S9^TOIp("d8",d8)</div></div><div  class=cdline ><div  class=cdrinum >.84c</div><div  class=cdmcmd >      I Ln=2  DO  Q:dQ</div></div><div  class=cdline ><div  class=cdrinum >.85c</div><div  class=cdmcmd >        .S <a href=CB-TOId2-mn.cb2.html >mn</a>=$$<a href=CB-TOId2-mn.cb2.html >mn</a>(p1),<a href=CB-TOId2-day.cb2.html >day</a>=$$<a href=CB-TOId2-day.cb2.html >day</a>(p2)</div></div><div  class=cdline ><div  class=cdrinum >.86c</div><div  class=cdmcmd >        .I '<a href=CB-TOId2-yr.cb2.html >yr</a> DO  </div></div><div  class=cdline ><div  class=cdrinum >.87c</div><div  class=cdmcmd >           ..S <a href=CB-TOId2-yr.cb2.html >yr</a>=$G(Ddef("yr")) I <a href=CB-TOId2-yr.cb2.html >yr</a> D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("defyr") Q</div></div><div  class=cdline ><div  class=cdrinum >.88c</div><div  class=cdmcmd >           ..S <a href=CB-TOId2-yr.cb2.html >yr</a>=$G(Dlst("yr")) D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("yrDlst")</div></div><div  class=cdline ><div  class=cdrinum >.89c</div><div  class=cdmcmd >        .S d8=<a href=CB-TOId2-yr.cb2.html >yr</a>_<a href=CB-TOId2-mn.cb2.html >mn</a>_<a href=CB-TOId2-day.cb2.html >day</a>_"_"  I d8'?8n1p D b^dv("Err d8","dQ,d8,d12,wd,p1,p2,p3,wki,ri") Q</div></div><div  class=cdline ><div  class=cdrinum >.90c</div><div  class=cdmcmd >        .D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("2/md")</div></div><div  class=cdline ><div  class=cdrinum >.91c</div><div  class=cdmcmd >        .D S9^TOIp("d8",d8)  ; <a href=CB-TOIp-S9.cb2.html >S9</a>(Wty,Wr)</div></div><div  class=cdline ><div  class=cdrinum >.92c</div><div  class=cdmcmd >      D b^dv("Err matching /","dQ,wd,wki,d8,d12,L,ri")</div></div><div  class=cdline ><div  class=cdrinum >.93c</div><div  class=cdmcmd >      Q</div></div><div  class=cdline ><div  class=cdrinum >.94c</div><div  class=cdmcmd >;*</div></div><div  class=cdline ><div  class=cdrinum >.95c</div><div  class=cdmcmd ><a href=CB-TOId2-dtn.cb2.html >dtn</a>(d) I $G(d)="" D bug^dv Q</div></div><div  class=cdline ><div  class=cdrinum >.96c</div><div  class=cdmcmd >      I d'?4.12n Q ""</div></div><div  class=cdline ><div  class=cdrinum >.97c</div><div  class=cdmcmd >      I d?12n S <a href=CB-TOId2-d12p.cb2.html >d12p</a>=$E(d,1,8)_"_"_$E(d,9,12) D S9^TOIp("d12",<a href=CB-TOId2-d12p.cb2.html >d12p</a>) Q <a href=CB-TOId2-d12p.cb2.html >d12p</a></div></div><div  class=cdline ><div  class=cdrinum >.98c</div><div  class=cdmcmd >      I d?8n S d8p=d_"_" D S9^TOIp("d8p",d8p) Q d8p</div></div><div  class=cdline ><div  class=cdrinum >.99c</div><div  class=cdmcmd >      I d?4n S y=$$<a href=CB-TOId2-yr.cb2.html >yr</a>(<a href=CB-TOId2-yr.cb2.html >yr</a>) I y S d8y=y D S9^TOIp("yr",d8y) Q d8p</div></div><div  class=cdline ><div  class=cdrinum >100c</div><div  class=cdmcmd >      Q ""</div></div><div  class=cdline ><div  class=cdrinum >101c</div><div  class=cdmcmd >;*</div></div><div  class=cdline ><div  class=cdrinum >102c</div><div  class=cdmcmd ><a href=CB-TOId2-Se.cb2.html >Se</a>(cd) I $G(cd)="" D bug^dv Q</div></div><div  class=cdline ><div  class=cdrinum >103c</div><div  class=cdmcmd >       I dE="" S dE=cd Q</div></div><div  class=cdline ><div  class=cdrinum >104c</div><div  class=cdmcmd >       S dE=dE_","_cd</div></div><div  class=cdline ><div  class=cdrinum >105c</div><div  class=cdmcmd >       Q</div></div><div  class=cdline ><div  class=cdrinum >106c</div><div  class=cdmcmd >;*$Q=<a href=CB-TOId2-yr.cb2.html >yr</a>'</div></div><div  class=cdline ><div  class=cdrinum >107c</div><div  class=cdmcmd ><a href=CB-TOId2-yr.cb2.html >yr</a>(y)  I $G(y)="" D bug^dv Q</div></div><div  class=cdline ><div  class=cdrinum >108c</div><div  class=cdmcmd >       I y?2n S y="20"_y</div></div><div  class=cdline ><div  class=cdrinum >109c</div><div  class=cdmcmd >       I y?4n,y&gt;1900,y&lt;2100 Q y</div></div><div  class=cdline ><div  class=cdrinum >110c</div><div  class=cdmcmd >       Q ""</div></div><div  class=cdline ><div  class=cdrinum >111c</div><div  class=cdmcmd >;*$Q=<a href=CB-TOId2-mn.cb2.html >mn</a>'</div></div><div  class=cdline ><div  class=cdrinum >112c</div><div  class=cdmcmd ><a href=CB-TOId2-mn.cb2.html >mn</a>(m) I $G(m)="" D bug^dv Q</div></div><div  class=cdline ><div  class=cdrinum >113c</div><div  class=cdmcmd >       I m?1.2n,m&lt;13 S:m?1n m=0_m Q m</div></div><div  class=cdline ><div  class=cdrinum >114c</div><div  class=cdmcmd >       Q ""</div></div><div  class=cdline ><div  class=cdrinum >115c</div><div  class=cdmcmd >;*</div></div><div  class=cdline ><div  class=cdrinum >116c</div><div  class=cdmcmd ><a href=CB-TOId2-day.cb2.html >day</a>(d) I $G(d)="" D bug^dv Q</div></div><div  class=cdline ><div  class=cdrinum >117c</div><div  class=cdmcmd >       I d&gt;31 Q ""</div></div><div  class=cdline ><div  class=cdrinum >118c</div><div  class=cdmcmd >       S ndm=$P("31,28,31,30,31,30,31,31,30,31,30,31",",",<a href=CB-TOId2-mn.cb2.html >mn</a>)</div></div><div  class=cdline ><div  class=cdrinum >119c</div><div  class=cdmcmd >       I ndm=28,<a href=CB-TOId2-yr.cb2.html >yr</a>#4,'(<a href=CB-TOId2-yr.cb2.html >yr</a>#400) S ndm=29</div></div><div  class=cdline ><div  class=cdrinum >120c</div><div  class=cdmcmd >       I d&gt;ndm Q ""</div></div><div  class=cdline ><div  class=cdrinum >121c</div><div  class=cdmcmd >       S:d?1n d=0_d </div></div><div  class=cdline ><div  class=cdrinum >122c</div><div  class=cdmcmd >       Q d</div></div><div  class=cdline ><div  class=cdrinum >123c</div><div  class=cdmcmd >;*       </div></div><div  class=cdline ><div  class=cdrinum >124c</div><div  class=cdmcmd ><a href=CB-TOId2-nyr.cb2.html >nyr</a>(n) I $G(n)'?2.4n D <a href=CB-TOId2-Se.cb2.html >Se</a>("yr rng '"_n)   ;  No Refs</div></div><div  class=cdline ><div  class=cdrinum >125c</div><div  class=cdmcmd >;* dt1 : <a href=CB-TOId2-yr.cb2.html >yr</a>, mo, <a href=CB-TOId2-day.cb2.html >day</a>,  opt: <a href=CB-hgh-hr.cb2.html >hr</a>,min</div></div><div  class=cdline ><div  class=cdrinum >126c</div><div  class=cdmcmd ><a href=CB-TOId2-Xdate.cb2.html >Xdate</a>  S <a href=CB-TOId2-day.cb2.html >day</a>="" ; I dt1["/" D day1 Q  ; may or may not have found date, <a href=CB-TOId2-day.cb2.html >day</a></div></div><div  class=cdline ><div  class=cdrinum >127c</div><div  class=cdmcmd >      I dt1?1.2n3A.4n D <a href=CB-TOId2-nMon.cb2.html >nMon</a> I <a href=CB-TOId2-day.cb2.html >day</a> D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("nJan") Q</div></div><div  class=cdline ><div  class=cdrinum >128c</div><div  class=cdmcmd >      I dt1?1"wk"1.2n D <a href=CB-TOId2-WKN.cb2.html >WKN</a> I <a href=CB-dv2-wh.cb2.html >wh</a> D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("WKn")  Q</div></div><div  class=cdline ><div  class=cdrinum >129c</div><div  class=cdmcmd >      I dt1?12n S <a href=CB-hgh-hr.cb2.html >hr</a>=$E(dt1,9,10),min=$E(dt1,11,12),dt1=$E(dt1,1,8) D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("n12") Q</div></div><div  class=cdline ><div  class=cdrinum >130c</div><div  class=cdmcmd >      I dt1?8n S <a href=CB-TOId2-yr.cb2.html >yr</a>=$E(dt1,1,4),<a href=CB-TOId2-mn.cb2.html >mn</a>=$E(dt1,5,6),<a href=CB-TOId2-day.cb2.html >day</a>=$E(dt1,7,8) D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("n8") Q</div></div><div  class=cdline ><div  class=cdrinum >131c</div><div  class=cdmcmd >      I dt1?4n D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("4nyr") D <a href=CB-TOId2-year.cb2.html >year</a>(dt1) I <a href=CB-TOId2-yr.cb2.html >yr</a> Q  ;No <a href=CB-TOId2-day.cb2.html >day</a> yet, mark used 2019 not <a href=CB-TOId2-time.cb2.html >time</a></div></div><div  class=cdline ><div  class=cdrinum >132c</div><div  class=cdmcmd >      D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("date-not")</div></div><div  class=cdline ><div  class=cdrinum >133c</div><div  class=cdmcmd >     ; Didnt find a date in this WD</div></div><div  class=cdline ><div  class=cdrinum >134c</div><div  class=cdmcmd >     Q</div></div><div  class=cdline ><div  class=cdrinum >135c</div><div  class=cdmcmd >    </div></div><div  class=cdline ><div  class=cdrinum >136c</div><div  class=cdmcmd >;*  10oct or 10oct19 : <a href=CB-TOId2-day.cb2.html >day</a>, <a href=CB-TOId2-mn.cb2.html >mn</a>, <a href=CB-TOId2-yr.cb2.html >yr</a></div></div><div  class=cdline ><div  class=cdrinum >137c</div><div  class=cdmcmd ><a href=CB-TOId2-nMon.cb2.html >nMon</a>  NEW d,m,n,y</div></div><div  class=cdline ><div  class=cdrinum >138c</div><div  class=cdmcmd >      S d=+dt1,m=$E(dt1,2,4) S:m m=$E(dt1,3,5)</div></div><div  class=cdline ><div  class=cdrinum >139c</div><div  class=cdmcmd >      S m=$$LC^TOIs(m),n=$F(moL,m_",")\4  ; 1-12 or 0</div></div><div  class=cdline ><div  class=cdrinum >140c</div><div  class=cdmcmd >      I 'n D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("xMocd") Q</div></div><div  class=cdline ><div  class=cdrinum >141c</div><div  class=cdmcmd >      S <a href=CB-TOId2-mn.cb2.html >mn</a>=n,<a href=CB-TOId2-day.cb2.html >day</a>=d</div></div><div  class=cdline ><div  class=cdrinum >142c</div><div  class=cdmcmd >      S y=$P(dt1,m,2) I (y?2n)!(y?4n) D <a href=CB-TOId2-year.cb2.html >year</a>(y) D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("1JanY") I <a href=CB-TOId2-yr.cb2.html >yr</a> Q</div></div><div  class=cdline ><div  class=cdrinum >143c</div><div  class=cdmcmd >      Q</div></div><div  class=cdline ><div  class=cdrinum >144c</div><div  class=cdmcmd >;*  ?2n or 4n <a href=CB-TOId2-year.cb2.html >year</a> ? : <a href=CB-TOId2-yr.cb2.html >yr</a></div></div><div  class=cdline ><div  class=cdrinum >145c</div><div  class=cdmcmd ><a href=CB-TOId2-year.cb2.html >year</a>(y)  I y?2n S y=20_y</div></div><div  class=cdline ><div  class=cdrinum >146c</div><div  class=cdmcmd >      I y&gt;1950,y&lt;2100 S <a href=CB-TOId2-yr.cb2.html >yr</a>=y Q</div></div><div  class=cdline ><div  class=cdrinum >147c</div><div  class=cdmcmd >      D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("4nnotYr")</div></div><div  class=cdline ><div  class=cdrinum >148c</div><div  class=cdmcmd >      Q</div></div><div  class=cdline ><div  class=cdrinum >149c</div><div  class=cdmcmd >;*  dy1~wk41 : <a href=CB-dv2-wh.cb2.html >wh</a> for use with <a href=CB-TOId2-day.cb2.html >day</a> of week, </div></div><div  class=cdline ><div  class=cdrinum >150c</div><div  class=cdmcmd ><a href=CB-TOId2-WKN.cb2.html >WKN</a>  S w=+$E(dt1,3,9)</div></div><div  class=cdline ><div  class=cdrinum >151c</div><div  class=cdmcmd >     I (w&lt;1)!(w&gt;53) D b^dv("Err wkn 1-53","dt1,w") Q</div></div><div  class=cdline ><div  class=cdrinum >152c</div><div  class=cdmcmd >     S:w?1n w=0_w S wjy=w,w6=<a href=CB-TOId2-yr.cb2.html >yr</a>_wjy</div></div><div  class=cdline ><div  class=cdrinum >153c</div><div  class=cdmcmd >       I w6'?6n D b^dv("Err w6 fmt","w6,w")</div></div><div  class=cdline ><div  class=cdrinum >154c</div><div  class=cdmcmd >     S <a href=CB-dv2-wh.cb2.html >wh</a>=$$w6wh^dd(w6)</div></div><div  class=cdline ><div  class=cdrinum >155c</div><div  class=cdmcmd >     Q</div></div><div  class=cdline ><div  class=cdrinum >156c</div><div  class=cdmcmd >;*</div></div><div  class=cdline ><div  class=cdrinum >157c</div><div  class=cdmcmd >;*  dt2, dyL  :  <a href=CB-TOId2-day.cb2.html >day</a> of week ("wed"), <a href=CB-dv2-wh.cb2.html >wh</a>(week#)  -&gt; <a href=CB-TOId2-day.cb2.html >day</a>,<a href=CB-TOId2-mn.cb2.html >mn</a>,<a href=CB-TOId2-yr.cb2.html >yr</a>, d8m~d8</div></div><div  class=cdline ><div  class=cdrinum >158c</div><div  class=cdmcmd ><a href=CB-TOId2-dydt.cb2.html >dydt</a>  S djwq=$F(dyL,dt2_",")-1\4 I djwq DO  Q:dQ</div></div><div  class=cdline ><div  class=cdrinum >159c</div><div  class=cdmcmd >        .; Calc <a href=CB-TOId2-day.cb2.html >day</a> from <a href=CB-TOId2-day.cb2.html >day</a> of week (djwq) +  Week <a href=CB-dzroz-as.cb2.html >as</a> <a href=CB-dv2-wh.cb2.html >wh</a></div></div><div  class=cdline ><div  class=cdrinum >160c</div><div  class=cdmcmd >        .S d8=$$whjd8^dd(<a href=CB-dv2-wh.cb2.html >wh</a>,djwq)</div></div><div  class=cdline ><div  class=cdrinum >161c</div><div  class=cdmcmd >        .I d8'?8n D b^dv("Err cal date from week &amp; <a href=CB-TOId2-day.cb2.html >day</a> of week","d8,<a href=CB-dv2-wh.cb2.html >wh</a>,djwq") Q</div></div><div  class=cdline ><div  class=cdrinum >162c</div><div  class=cdmcmd >        .S <a href=CB-TOId2-yr.cb2.html >yr</a>=$E(d8,1,4),<a href=CB-TOId2-mn.cb2.html >mn</a>=$E(d8,5,6),<a href=CB-TOId2-day.cb2.html >day</a>=$E(d8,7,8)</div></div><div  class=cdline ><div  class=cdrinum >163c</div><div  class=cdmcmd >        .D S9^TOIp("d8",d8)</div></div><div  class=cdline ><div  class=cdrinum >164c</div><div  class=cdmcmd >      I <a href=CB-TOId2-day.cb2.html >day</a>  Q  ; Ignore if have date, redundant - vs ck consistent-- below</div></div><div  class=cdline ><div  class=cdrinum >165c</div><div  class=cdmcmd >      DO  ; ck <a href=CB-TOId2-day.cb2.html >day</a> of wk vs d8/d12</div></div><div  class=cdline ><div  class=cdrinum >166c</div><div  class=cdmcmd >        .I d12?12n S d8=$E(d12,1,8)</div></div><div  class=cdline ><div  class=cdrinum >167c</div><div  class=cdmcmd >        .E  S:<a href=CB-TOId2-mn.cb2.html >mn</a>?1n <a href=CB-TOId2-mn.cb2.html >mn</a>=0_<a href=CB-TOId2-mn.cb2.html >mn</a> S:<a href=CB-TOId2-day.cb2.html >day</a>?1n <a href=CB-TOId2-day.cb2.html >day</a>=0_<a href=CB-TOId2-day.cb2.html >day</a> S:<a href=CB-TOId2-yr.cb2.html >yr</a>?2n <a href=CB-TOId2-yr.cb2.html >yr</a>=20_<a href=CB-TOId2-yr.cb2.html >yr</a> S d8=<a href=CB-TOId2-yr.cb2.html >yr</a>_<a href=CB-TOId2-mn.cb2.html >mn</a>_<a href=CB-TOId2-day.cb2.html >day</a></div></div><div  class=cdline ><div  class=cdrinum >168c</div><div  class=cdmcmd >        .D <a href=CB-TOId2-cdjw.cb2.html >cdjw</a>(d12) ; d8, djwq  seq week #</div></div><div  class=cdline ><div  class=cdrinum >169c</div><div  class=cdmcmd >        .I djw=djwq Q  ;redundant, all is ok</div></div><div  class=cdline ><div  class=cdrinum >170c</div><div  class=cdmcmd >        .D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("day-not-eq") </div></div><div  class=cdline ><div  class=cdrinum >171c</div><div  class=cdmcmd >        .D b^dv("mon NOT eq m/d","djw,djwq,<a href=CB-TOId2-day.cb2.html >day</a>,<a href=CB-dmnu-L2.cb2.html >L2</a>,L0,ri")</div></div><div  class=cdline ><div  class=cdrinum >172c</div><div  class=cdmcmd >      I <a href=CB-TOId2-day.cb2.html >day</a>="" DO  Q</div></div><div  class=cdline ><div  class=cdrinum >173c</div><div  class=cdmcmd >        .NEW dh,d8a,d8b,d12d</div></div><div  class=cdline ><div  class=cdrinum >174c</div><div  class=cdmcmd >        .S xwh=$G(Ddef("wh")) I xwh DO   I d8 Q</div></div><div  class=cdline ><div  class=cdrinum >175c</div><div  class=cdmcmd >           ..S d8=$$whjd8^dd(xwh,djwq)</div></div><div  class=cdline ><div  class=cdrinum >176c</div><div  class=cdmcmd >           ..I d8'?8n D b^dv("Err def day","d8,xwh,<a href=CB-dv2-wh.cb2.html >wh</a>,djwq") Q</div></div><div  class=cdline ><div  class=cdrinum >177c</div><div  class=cdmcmd >           ..S <a href=CB-TOId2-yr.cb2.html >yr</a>=$E(d8,1,4),<a href=CB-TOId2-mn.cb2.html >mn</a>=$E(d8,5,6),<a href=CB-TOId2-day.cb2.html >day</a>=$E(d8,7,8)</div></div><div  class=cdline ><div  class=cdrinum >178c</div><div  class=cdmcmd >        .S d12d=$G(Dlst("d12")) I d12d="" S d12d=$G(Dlst("d12"))</div></div><div  class=cdline ><div  class=cdrinum >179c</div><div  class=cdmcmd >        .S d8a=$E(d12d,1,8) I d8a'?8n Q</div></div><div  class=cdline ><div  class=cdrinum >180c</div><div  class=cdmcmd >        .D <a href=CB-TOId2-cdjw.cb2.html >cdjw</a>(d8a)</div></div><div  class=cdline ><div  class=cdrinum >181c</div><div  class=cdmcmd >        .S d12=d8b_$E(d12,9,12)</div></div><div  class=cdline ><div  class=cdrinum >182c</div><div  class=cdmcmd >        .S <a href=CB-TOId2-day.cb2.html >day</a>=$E(d12,7,8)</div></div><div  class=cdline ><div  class=cdrinum >183c</div><div  class=cdmcmd >        .D ^devlog("Log mon -&gt; day","day,djwq,wh")</div></div><div  class=cdline ><div  class=cdrinum >184c</div><div  class=cdmcmd >      S:<a href=CB-TOId2-mn.cb2.html >mn</a>?1n <a href=CB-TOId2-mn.cb2.html >mn</a>=0_<a href=CB-TOId2-mn.cb2.html >mn</a> S:<a href=CB-TOId2-day.cb2.html >day</a>?1n <a href=CB-TOId2-day.cb2.html >day</a>=0_<a href=CB-TOId2-day.cb2.html >day</a></div></div><div  class=cdline ><div  class=cdrinum >185c</div><div  class=cdmcmd >      S d8m=<a href=CB-TOId2-yr.cb2.html >yr</a>_<a href=CB-TOId2-mn.cb2.html >mn</a>_<a href=CB-TOId2-day.cb2.html >day</a></div></div><div  class=cdline ><div  class=cdrinum >186c</div><div  class=cdmcmd >      Q</div></div><div  class=cdline ><div  class=cdrinum >187c</div><div  class=cdmcmd >;*  : d8b, djw, <a href=CB-TOId2-day.cb2.html >day</a>'</div></div><div  class=cdline ><div  class=cdrinum >188c</div><div  class=cdmcmd ><a href=CB-TOId2-cdjw.cb2.html >cdjw</a>(d8a) I $G(d8a)'?8n D b^dv("cdjw-<a href=CB-GAs-arg.cb2.html >arg</a>-not?8n") Q</div></div><div  class=cdline ><div  class=cdrinum >189c</div><div  class=cdmcmd >        S dh=$$d8dh^dd(d8a)</div></div><div  class=cdline ><div  class=cdrinum >190c</div><div  class=cdmcmd >        S whj=$$dhwhj^dd(dh)</div></div><div  class=cdline ><div  class=cdrinum >191c</div><div  class=cdmcmd >        S djw=$P(whj,"-",2)</div></div><div  class=cdline ><div  class=cdrinum >192c</div><div  class=cdmcmd >        S d8b=$$whjd8^dd(+whj,djwq)  ;diff <a href=CB-TOId2-day.cb2.html >day</a> of week -&gt; d8</div></div><div  class=cdline ><div  class=cdrinum >193c</div><div  class=cdmcmd >        D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("d12-d8-<a href=CB-dv2-wh.cb2.html >wh</a>-d8")</div></div><div  class=cdline ><div  class=cdrinum >194c</div><div  class=cdmcmd >        S <a href=CB-TOId2-day.cb2.html >day</a>=$E(d8b,7,8)  ;d8 may be null</div></div><div  class=cdline ><div  class=cdrinum >195c</div><div  class=cdmcmd >        I <a href=CB-TOId2-day.cb2.html >day</a>="" D b^dv("wed -&gt; d8 err","day,d8a,dh,<a href=CB-dv2-wh.cb2.html >wh</a>,djw,djwq,<a href=CB-dmnu-L2.cb2.html >L2</a>,L0,ri")</div></div><div  class=cdline ><div  class=cdrinum >196c</div><div  class=cdmcmd >      Q</div></div><div  class=cdline ><div  class=cdrinum >197c</div><div  class=cdmcmd >;* tm1 : <a href=CB-hgh-hr.cb2.html >hr</a>, min</div></div><div  class=cdline ><div  class=cdrinum >198c</div><div  class=cdmcmd ><a href=CB-TOId2-time.cb2.html >time</a>  ;</div></div><div  class=cdline ><div  class=cdrinum >199c</div><div  class=cdmcmd >      I $P(tm1,"pm")_"pm"=tm1 S apm="pm",tm1=$P(tm1,"pm") D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("pm")</div></div><div  class=cdline ><div  class=cdrinum >200c</div><div  class=cdmcmd >      I $P(tm1,"p")_"p"=tm1 S apm="pm",tm1=$P(tm1,"p") D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("p")</div></div><div  class=cdline ><div  class=cdrinum >201c</div><div  class=cdmcmd >      I $P(tm1,"am")_"am"=tm1 S apm="am",tm1=$P(tm1,"am") D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("am")</div></div><div  class=cdline ><div  class=cdrinum >202c</div><div  class=cdmcmd >      I $P(tm1,"a")_"a"=tm1 S apm="am",tm1=$P(tm1,"a") D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("a")</div></div><div  class=cdline ><div  class=cdrinum >203c</div><div  class=cdmcmd >      I tm1?1.2n1":"1.2n S <a href=CB-hgh-hr.cb2.html >hr</a>=$P(tm1,":"),min=+$P(tm1,":",2) D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("n:n")</div></div><div  class=cdline ><div  class=cdrinum >204c</div><div  class=cdmcmd >      ; Simple numbers- only if no <a href=CB-hgh-hr.cb2.html >hr</a> yet</div></div><div  class=cdline ><div  class=cdrinum >205c</div><div  class=cdmcmd >      I tm1?3.4n,<a href=CB-hgh-hr.cb2.html >hr</a>="" S <a href=CB-hgh-hr.cb2.html >hr</a>=tm1\100,min=tm1#100 D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("3-4nhrmin")</div></div><div  class=cdline ><div  class=cdrinum >206c</div><div  class=cdmcmd >      I tm1?1.2n,<a href=CB-hgh-hr.cb2.html >hr</a>="" S <a href=CB-hgh-hr.cb2.html >hr</a>=+tm1,min="00" D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("1-2nhrmin00")</div></div><div  class=cdline ><div  class=cdrinum >207c</div><div  class=cdmcmd >      I apm="pm",<a href=CB-hgh-hr.cb2.html >hr</a>'="",hr&lt;12 S <a href=CB-hgh-hr.cb2.html >hr</a>=<a href=CB-hgh-hr.cb2.html >hr</a>+12 D <a href=CB-TOId2-dpr.cb2.html >dpr</a>("hr+12")</div></div><div  class=cdline ><div  class=cdrinum >208c</div><div  class=cdmcmd >      S <a href=CB-TOId2-dtm.cb2.html >dtm</a>=<a href=CB-hgh-hr.cb2.html >hr</a>_min</div></div><div  class=cdline ><div  class=cdrinum >209c</div><div  class=cdmcmd >      D S9^TOIp("dtm",<a href=CB-TOId2-dtm.cb2.html >dtm</a>)</div></div><div  class=cdline ><div  class=cdrinum >210c</div><div  class=cdmcmd >      Q</div></div><div  class=cdline ><div  class=cdrinum >211c</div><div  class=cdmcmd ></div></div><div  class=cdline ><div  class=cdrinum >212c</div><div  class=cdmcmd >;*</div></div><div  class=cdline ><div  class=cdrinum >213c</div><div  class=cdmcmd >;*  Add process <a href=CB-dv2-log.cb2.html >log</a> cd to  Lpr  (identical to <a href=CB-TOId2-dpr.cb2.html >dpr</a>() in ^qdTOIin</div></div><div  class=cdline ><div  class=cdrinum >214c</div><div  class=cdmcmd ><a href=CB-TOId2-dpr.cb2.html >dpr</a>(cd) I Lpr'="" S Lpr=Lpr_", "_cd Q</div></div><div  class=cdline ><div  class=cdrinum >215c</div><div  class=cdmcmd >        S Lpr=cd Q</div></div><div  class=cdline ><div  class=cdrinum >216c</div><div  class=cdmcmd >;*    * * * * *</div></div><div  class=cdline ><div  class=cdrinum >217c</div><div  class=cdmcmd ></div></div><div  class=cdline ><div  class=cdrinum >218c</div><div  class=cdmcmd >      </div></div></div><div  class=ft >by ^mwHmr 07 APR 2023 10:17 PM</div><h3> 07APR2023 22:17   by ^hgh</h3>
</body>
</html>
